<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>mickeyf.dev</title>
    <link rel="stylesheet" href="./assets/styles/style.css">
</head>

<body x-data="{ page: 'home' }" 
    x-init="updateScripts(page); $watch('page', value => updateScripts(value));">

    <audio id="music"></audio>
    <!-- Navigation bar -->
    <div id="central">
        <div id="header">
            <ul id="nav">
                <li><a href="/" @click="page='home'" id="home">Home</a></li>
                <li><a href="/#/dancing-circles" @click="page='dancing-circles'">Animations</a></li>
                <li><a href="/#/user/create" @click="page='register'">Register</a></li>
                <li><a href="/#/login" @click="page='login'">Log in</a></li>
            </ul>
        </div>

        <!-- Content from Dancing Circles Page -->
        <template x-if="(page === 'dancing-circles')">
            <div id="dc-content">
                <h1 id="dc-title">Dancing Circles</h1>
                <canvas id="dancing-circles"></canvas>
                <label id="upload-button" for="file-upload">Upload Music</label>
                <input type="file" name="fileupload" id="file-upload" accept="audio/*" />
            </div>
        </template>

        <!-- Content from pages handled with index.js -->
        <div id="content" x-show="(page !== 'dancing-circles')"></div>
    </div>
    <!-- Dynamic scripts -->
    <script>
        function updateScripts(currentPage) {
            // Remove existing script if any
            const existingScript = document.getElementById("dynamic-script");
            if (existingScript) {
                existingScript.remove();
            }

            // Create new script element
            let myCoolCode = document.createElement("script");
            myCoolCode.id = "dynamic-script";

            switch (currentPage) {
                case "dancing-circles":
                    myCoolCode.setAttribute("src", "dist/circleAnim.js");
                    break;
                default:
                    myCoolCode.setAttribute("src", "dist/index.js");
                    break;
        }

        // Append the new script to the body
        document.body.appendChild(myCoolCode);
        }
        updateScripts();
    </script>
</body>

</html>